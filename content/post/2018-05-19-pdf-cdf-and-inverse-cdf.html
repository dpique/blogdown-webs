---
title: Transforming values between different scales using R
author: Daniel Pique
date: '2018-05-19'
runtime: shiny
slug: pdf-cdf-and-inverse-cdf
categories:
  - Math
tags:
  - probability
  - pdf
  - cdf
  - Gaussian
  - Logit
  - Probit
---



<p>In this post, we will cover the relationship between the probability density function (PDF), the cumulative probability density function (CDF), and the inverse CDF. The inverse CDF is also know as the Quantile function (weâ€™ll see why later).</p>
<p>This post stemmed from my interest in transforming a set of values on a [0,1] scale to values corresponsing to those on a Normal distribution. This led to me learning about something called the inverse transform method. Basically, what this says is that we first start off with a uniform sample of values between 0 and 1.</p>
<pre class="r"><code>u &lt;- runif(n = 100, min = 0, max = 1)
hist(u)</code></pre>
<p><img src="/post/2018-05-19-pdf-cdf-and-inverse-cdf_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Then, for each of these 100 numbers <span class="math inline">\(u_1, u_2, ..., u_{100}\)</span> , we return the largest number from the distribution <span class="math inline">\(N(X, \mu, \sigma))\)</span> such that <span class="math inline">\(N(-\infty &lt; X&lt; x) \leq u_i\)</span>. In R, we accomplish this with the function <code>qnorm</code></p>
<pre class="r"><code>mu &lt;- 0
sigma &lt;- 1
qnorm(p = u, mean = mu, sd = sigma)</code></pre>
<pre><code>##   [1] -0.607165621 -0.320648317 -1.745501995 -1.498713964 -0.991144239
##   [6]  0.164429482 -0.955891050 -1.217172973  1.186194180 -0.378705944
##  [11]  1.065550491  0.145554828  1.094675955  1.672140170  0.814472494
##  [16] -1.017332669  2.607063901  0.332539362 -0.577165852 -0.182455481
##  [21] -1.396038760  1.139536641 -0.288179773  0.913004284 -0.233416726
##  [26] -0.407584245 -0.423568201  0.491656079  0.298345217  0.819952086
##  [31]  1.031798298  1.607410429 -1.913917898 -0.420214653 -1.097575822
##  [36] -0.821732283  2.041601392 -1.826128355 -1.540600005 -0.897939678
##  [41]  0.411246088 -0.809086597  0.550011545  1.929113434 -1.407825704
##  [46]  0.225619353  1.429051905 -1.294652931 -1.962249306  0.561072346
##  [51]  1.308887439 -0.338607115 -0.241487323 -1.036487844 -0.401806488
##  [56] -0.140774733 -0.373707049 -1.378844477 -0.212266949 -1.146628873
##  [61] -2.464107160  1.194151285 -2.819870809 -0.114716323 -0.048344619
##  [66]  0.278356064  1.451837341 -2.148498786 -0.302246324  0.010949849
##  [71] -0.512175895 -1.391395684 -0.537882480 -0.369220984 -0.914248547
##  [76]  1.006039483  0.528563126  0.657404028  0.184760547 -3.565488551
##  [81] -2.225533096  0.474609976  0.795370897 -0.772004779  0.213611726
##  [86] -0.054472537 -0.949690497  1.346321083  0.100974444 -0.430331666
##  [91] -0.650573685  0.834630392 -0.002095442  1.824551758  2.928479415
##  [96] -1.845698490  1.283760328  0.837487722  0.733009960  0.872073767</code></pre>
<p>The idea is to take the numbers between 0 and 1 and then pass them to the inverse CDF (<code>qnorm</code>) of the desired distribution (in this case the Normal distribution). The CDF can be generated using <code>pnorm</code>, and its inverse can be generated using <code>qnorm</code>. While <code>pnorm</code> takes in a quantile and returns a probability, <code>qnorm</code> takes in a probability and returns a quantile.</p>
<div id="section-quantiles" class="section level3">
<h3>Quantiles</h3>
<p>A quantile is a value that represents a set number of sd away from 0. Specifically, the quantile function <code>qnorm</code> specifies, for a given probability in the probability distribution of a random variable, the value at which the probability of the random variable <span class="math inline">\(N(\mu, \sigma)\)</span> is less than or equal to the given probability. The quantile function <code>qnorm</code> is also known as the percent-point function or inverse CDF. In the specific case of the standard normal distribution, the quantile function <code>qnorm</code> is known as the <em>probit</em>.</p>
</div>
<div id="section-two-notes-about-the-inverse-cdf" class="section level3">
<h3>Two notes about the inverse CDF</h3>
<ol style="list-style-type: decimal">
<li><p>The inverse CDF <a href="https://scicomp.stackexchange.com/questions/24650/numerical-methods-for-calculating-the-inverse-cdf-when-closed-form-approximation">does not have a closed-form solution</a>, so it is generated using numerical methods.</p></li>
<li><p>The inverse CDF depends on the same parameters as the CDF. In the case of the Gaussian, the inverse CDF depends on the value of mu and sigma.</p></li>
</ol>
<p>Note that we can transform the original uniform numbers to a Gaussian with any parameters mu and sigma because the Gaussian is scale invariant. We demonstrate this below, transforming the uniform values <code>u</code> to follow a Gaussian with mean 5 and sd 3:</p>
<pre class="r"><code>mu &lt;- 5; sigma &lt;- 3
probit &lt;- qnorm(p = u, mean = mu, sd = sigma)
mean(probit)</code></pre>
<pre><code>## [1] 4.633282</code></pre>
<pre class="r"><code>sd(probit)</code></pre>
<pre><code>## [1] 3.567591</code></pre>
<pre class="r"><code>hist(probit)</code></pre>
<p><img src="/post/2018-05-19-pdf-cdf-and-inverse-cdf_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="section-additional-readings" class="section level3">
<h3>Additional readings</h3>
<p>Below is a link to an <a href="https://www.countbayesie.com/blog/2015/4/4/parameter-estimation-the-pdf-cdf-and-quantile-function">excellent post</a> about the CDF and inverse CDF</p>
</div>
